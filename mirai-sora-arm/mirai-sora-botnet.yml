# Note:
# Mirai primarily targets IoT/embedded devices where neither
# Sysmon nor auditd is available. These rules are intended for
# use on Linux honeypots or general-purpose Linux systems.
#
# File watches must be configured accordingly, e.g.:
#   sudo auditctl -w /dev/watchdog -p rwa -k mirai_watchdog
#   sudo auditctl -w /dev/misc/watchdog -p rwa -k mirai_watchdog

title: Mirai SORA - watchdog manipulation
id: 7b0b4447-3a21-467e-b530-6f93c39a3d2c
status: experimental
description: |
  Detects access to watchdog device files, used by Mirai to prevent device reboot.
  Based on YARA rules detecting: "/dev/watchdog", "/dev/misc/watchdog"
author: Andras Gemes
date: 2025/04/04
references:
  - https://shadowshell.io/mirai-sora-botnet
  - https://github.com/gemesa/threat-detection-rules/tree/main/mirai-sora-arm
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-taxonomy.md
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-modifiers.md
logsource:
  product: linux
  service: auditd
detection:
  selection:
    type: PATH
    name:
      - "/dev/watchdog"
      - "/dev/misc/watchdog"
  condition: selection
falsepositives:
  - Legitimate watchdog daemon usage
level: medium
tags:
  # tactic - https://attack.mitre.org/tactics/enterprise/
  - attack.persistence
  # Boot or Logon Autostart Execution - https://attack.mitre.org/techniques/T1547/
  - attack.t1547

---
title: Mirai SORA - Busybox execution with SORA identifier
id: ede181a6-6b49-48b3-bdb4-2cc6560409ac
status: experimental
description: |
  Detects busybox execution patterns associated with Mirai SORA.
  Note: The actual string "SORA" is XOR encrypted in the binary, but may appear in execution.
author: Andras Gemes
date: 2025/04/04
references:
  - https://shadowshell.io/mirai-sora-botnet
  - https://github.com/gemesa/threat-detection-rules/tree/main/mirai-sora-arm
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-taxonomy.md
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-modifiers.md
logsource:
  product: linux
  service: auditd
detection:
  selection:
    type: EXECVE
    a0|contains: "busybox"
    a1|contains: "SORA"
  condition: selection
falsepositives:
  - Unlikely
level: critical
tags:
  # tactic - https://attack.mitre.org/tactics/enterprise/
  - attack.execution
  # Command and Scripting Interpreter: Unix Shell - https://attack.mitre.org/techniques/T1059/004/
  - attack.t1059.004

---
title: Mirai SORA - competitor botnet detection scan (.anime)
id: c077a2a4-f33a-4841-abe4-e795311bc54c
status: experimental
description: |
  Detects file access to .anime, a marker used by the Anime botnet.
  Mirai variants scan for this file to identify and kill competitor infections.
author: Andras Gemes
date: 2025/04/04
references:
  - https://shadowshell.io/mirai-sora-botnet
  - https://github.com/gemesa/threat-detection-rules/tree/main/mirai-sora-arm
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-taxonomy.md
# https://github.com/SigmaHQ/sigma-specification/blob/main/specification/sigma-appendix-modifiers.md
logsource:
  product: linux
  service: auditd
detection:
  selection:
    type: PATH
    name|endswith: ".anime"
  condition: selection
falsepositives:
  - Unlikely
level: high
tags:
  # tactic - https://attack.mitre.org/tactics/enterprise/
  - attack.discovery
  # File and Directory Discovery - https://attack.mitre.org/techniques/T1083/
  - attack.t1083
